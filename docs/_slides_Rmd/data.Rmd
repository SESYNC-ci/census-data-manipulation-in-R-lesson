---
---

## Sample data

We will use the [Portal teaching database](http://github.com/weecology/portal-teachingdb), a simplified dataset derived from a long-term study of animal populations in the Chihuahuan Desert.

![]({{ site.baseurl }}/images/portal-oct-07-15.jpg){: width="40%"}  
*Credit: [The Portal Project](https://portalproject.wordpress.com)*
{:.captioned}

===

```{r read_data, title="{{ site.handouts }}"}
animals <- read.csv("data/animals.csv")
```

```{r}
str(animals)
```

<aside class="notes" markdown="block">

The teaching dataset includes three tables: two contain summary information on the study plots and observed species, respectively, while the third and largest one (animals) lists all individual observations. We only need the animals table for this lesson.

</aside>

===

Modify the function to specify what string in the CSV file represents NAs, a.k.a. data that is not-available or missing.

```{r read_data_na, title="{{ site.handouts }}"}
animals <- read.csv("data/animals.csv", na.strings = "")
```

Question
: What has changed?

Answer
: {:.fragment} The `str` shows that the factors have one less level, and the empty string is not included.

===

Aleternatively, we could pull the table from the PostgreSQL database server using R as our database client.

```{r read_dbdata_na, title="{{ site.handouts }}", eval=FALSE}
library(dplyr)
con <- dbConnect(RPostgreSQL::PostgreSQL(), host = 'localhost', dbname = 'portal')
animals_db <- tbl(con, 'animals')
animals <- collect(animals_db)
```

The difference between `animals_db` and `animals` is where the data are. For `animals_db` the data remain on the PostgreSQL server, while `collect` copies the data to the client.
